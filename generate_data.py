"""
数据生成脚本：生成教学材料chunks
"""
import json
import os
from data_processor import DataProcessor
import config


def generate_sample_materials():
    """生成示例教学材料"""
    
    # 模块1：Movement Systems
    movement_systems_text = """
    运动系统是人体进行各种运动的基础。运动系统主要包括骨骼系统、肌肉系统和神经系统。
    
    骨骼系统由206块骨头组成，分为中轴骨和附肢骨。中轴骨包括颅骨、脊柱和胸廓。附肢骨包括上肢骨和下肢骨。
    骨骼的主要功能是支撑身体、保护内脏器官、储存矿物质和产生血细胞。
    
    肌肉系统包括三种类型的肌肉：骨骼肌、平滑肌和心肌。骨骼肌是随意肌，受意识控制。
    肌肉通过收缩产生力量，使身体产生运动。肌肉收缩需要能量，主要来自ATP的分解。
    
    神经系统控制肌肉的收缩。运动神经元将信号从大脑传递到肌肉，引起肌肉收缩。
    神经肌肉接头是神经元和肌肉纤维之间的连接点，神经递质乙酰胆碱在这里传递信号。
    
    运动的基本原理包括杠杆原理、力臂和力矩。人体运动可以看作是一系列杠杆系统。
    第一类杠杆的支点在中间，如头部点头运动。第二类杠杆的阻力点在中间，如踮脚尖。
    第三类杠杆的动力点在中间，如屈肘运动。
    
    运动技能的学习包括认知阶段、联结阶段和自动化阶段。认知阶段需要理解动作要领。
    联结阶段需要反复练习，形成动作模式。自动化阶段动作变得流畅自然。
    
    运动训练的基本原则包括超负荷原则、渐进性原则、特异性原则和可逆性原则。
    超负荷原则要求训练强度超过日常水平。渐进性原则要求逐步增加训练负荷。
    特异性原则要求训练内容与目标运动相关。可逆性原则说明停止训练会导致能力下降。
    """
    
    # 模块2：Health and Aerobic Training Design
    aerobic_training_text = """
    有氧训练是提高心肺功能和健康水平的重要方法。有氧训练是指以有氧代谢为主的运动。
    
    有氧代谢是指细胞在有氧条件下，通过氧化葡萄糖和脂肪酸产生ATP的过程。
    有氧代谢的主要场所是线粒体，产生的ATP数量多但速度慢。
    
    最大摄氧量（VO2max）是评价有氧能力的重要指标。VO2max是指人体在最大运动强度下，
    单位时间内能够摄取和利用的最大氧气量。VO2max受遗传、年龄、性别、训练水平等因素影响。
    
    有氧训练的设计需要考虑训练强度、训练频率、训练时间和训练类型。
    训练强度可以通过心率、最大摄氧量百分比、主观疲劳度等指标来控制。
    
    靶心率区间通常设定为最大心率的60%-80%。最大心率可以用220减去年龄来估算。
    例如，30岁的人最大心率约为190次/分，靶心率区间为114-152次/分。
    
    有氧训练的类型包括持续训练、间歇训练和法特莱克训练。
    持续训练是指以恒定强度进行较长时间的运动，如慢跑30分钟。
    间歇训练是指高强度运动和低强度恢复交替进行，如快跑1分钟，慢走2分钟，重复10次。
    法特莱克训练是指根据地形和感觉自由变换强度的训练。
    
    有氧训练的健康益处包括改善心血管功能、降低血压、改善血脂、增强免疫功能、
    控制体重、改善心理健康等。规律的有氧训练可以降低心血管疾病、糖尿病、肥胖等慢性病的风险。
    
    训练计划的制定需要考虑个体的健康状况、运动基础、时间安排和目标。
    初学者应该从低强度、短时间开始，逐步增加强度和时长。
    建议每周进行至少150分钟的中等强度有氧运动，或75分钟的高强度有氧运动。
    """
    
    # 历史Q&A示例
    qa_text = """
    问：什么是最大摄氧量？
    答：最大摄氧量（VO2max）是人体在最大运动强度下，单位时间内能够摄取和利用的最大氧气量。
    它是评价有氧能力的重要指标，可以通过递增负荷运动测试来测量。
    
    问：有氧训练和无氧训练有什么区别？
    答：有氧训练主要依赖有氧代谢，强度较低，持续时间较长，如慢跑、游泳。
    无氧训练主要依赖无氧代谢，强度高，持续时间短，如短跑、举重。
    
    问：如何提高运动技能？
    答：提高运动技能需要反复练习，遵循认知、联结、自动化三个阶段。
    在认知阶段要理解动作要领，在联结阶段要反复练习形成动作模式，
    在自动化阶段动作变得流畅自然。同时要注意反馈和纠正错误。
    
    问：运动训练的超负荷原则是什么？
    答：超负荷原则是指训练强度必须超过日常水平，才能引起身体适应和进步。
    但超负荷要适度，过度训练会导致损伤和疲劳。应该循序渐进地增加训练负荷。
    """
    
    return [
        {
            'text': movement_systems_text,
            'source': 'movement_systems_textbook',
            'module_hint': 'Movement Systems',
            'objective_hint': '理解运动系统的基本结构和功能'
        },
        {
            'text': aerobic_training_text,
            'source': 'aerobic_training_textbook',
            'module_hint': 'Health and Aerobic Training Design',
            'objective_hint': '掌握有氧训练的设计原理和方法'
        },
        {
            'text': qa_text,
            'source': 'historical_qa',
            'module_hint': 'General',
            'objective_hint': '常见问题解答'
        }
    ]


def main():
    """主函数：生成数据"""
    print("开始生成教学材料数据...")
    
    # 创建数据处理器
    processor = DataProcessor(chunk_size=300, chunk_overlap=30)
    
    # 生成示例材料
    materials = generate_sample_materials()
    
    # 处理材料
    for material in materials:
        processor.process_text(
            material['text'],
            material['source'],
            material['module_hint'],
            material['objective_hint']
        )
    
    # 保存chunks
    processor.save_chunks()
    
    print(f"数据生成完成！共生成 {len(processor.chunks)} 个chunks")


if __name__ == '__main__':
    main()

